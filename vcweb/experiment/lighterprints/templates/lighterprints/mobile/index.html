{% load static from staticfiles %}
<!DOCTYPE html>
<html>
    <head>
        <title>Lighter Footprints</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="{% static 'css/lighterprints/mobile/themeroller.css' %}" />
        <link rel="stylesheet" href="//ajax.aspnetcdn.com/ajax/jquery.mobile/1.3.0/jquery.mobile.structure-1.3.0.min.css" />
        <link rel="stylesheet" href="{% static 'css/lighterprints/font-awesome/jqm-icon-pack-3.0.0-fa.css' %}"/>
        <link rel="stylesheet" href="{% static 'css/lighterprints/icons.css' %}" />
        <link rel="stylesheet" href="{% static 'css/lighterprints/mobile/style.css' %}"/>
        {% with jquery_version="1.8.3" %}
        <script src='//ajax.googleapis.com/ajax/libs/jquery/{{jquery_version}}/jquery.min.js'></script>
        {% endwith %}
        <script src="//ajax.aspnetcdn.com/ajax/jquery.mobile/1.3.0/jquery.mobile-1.3.0.min.js">
        </script>
        <!-- KnockoutJS for MVVM-->
        <script src='{% static "js/ko/knockout.min.js" %}'></script>
        <script src='{% static "js/ko/knockout.mapping.min.js" %}'></script>
        <!--Local JS-->
        <script src='{% static "js/lighterprints/mobile/controller.js" %}'>
        </script>
        <script>
            $(document).on('pagecreate', function(event){
                var viewModelData = $.parseJSON("{{view_model_json|escapejs}}");
                var viewModel = new LighterFootprintsModel(viewModelData);
                viewModel.perform1 = function(challengeModel) {
                    if (!challengeModel.availableNow()) {
                        console.debug("tried to perform an activity that's not available right now");
                        console.debug(challengeModel);
                        return;
                    }
                    var id = challengeModel.pk();
                    var formData = { participant_group_id: viewModel.participantGroupId(), activity_id:id };
                    $.post("{% url 'lighterprints:perform_activity' %}", formData, function(data) {
                        if (data.success) {
                            console.debug(data);
                            $("#popupDialog1").popup('open');
                                    ko.mapping.fromJSON(data.viewModel, viewModel);
                            viewModel.lastPerformedActivity(challengeModel);
                            console.debug('refreshing lists');
                            $('#challengesList1').listview('refresh');
                            $('#teamList1').listview('refresh');
                            $('#teamActivityList1').listview('refresh');
                        }
                        else {
                            console.debug("ERROR: " + data.message);
                            }
                    });
                };
                viewModel.perform2 = function(challengeModel) {
                    if (!challengeModel.availableNow()) {
                        console.debug("tried to perform an activity that's not available right now");
                        console.debug(challengeModel);
                        return;
                    }
                    var id = challengeModel.pk();
                    var formData = { participant_group_id: viewModel.participantGroupId(), activity_id:id };
                    $.post("{% url 'lighterprints:perform_activity' %}", formData, function(data) {
                        if (data.success) {
                            console.debug(data);
                            $("#popupDialog3").popup('open');
                                    ko.mapping.fromJSON(data.viewModel, viewModel);
                            viewModel.lastPerformedActivity(challengeModel);
                            console.debug('refreshing lists');
                            $('#challengesList3').listview('refresh');
                            $('#teamList3').listview('refresh');
                            $('#teamActivityList3').listview('refresh');
                        }
                        else {
                            console.debug("ERROR: " + data.message);
                        }
                    });
                };
                viewModel.send = function() {
	                if ($('#chatText').val()) {
                        var formData = {participant_group_id: viewModel.participantGroupId(), message:$('#chatText').val()};
                        $.post('/lighterprints/api/message', formData, function(response){
                            if (response.success) {
                                console.debug("successful post - updated view model: ");
                                ko.mapping.fromJS(response.viewModel, viewModel);
				console.debug('refresh chatMessage List');
				$('#chatMessageList').listview('refresh');
                            }
                            else {
                                console.debug("unable to post message to server");
                                console.debug(response);
                            }
                        });
                        $('#chatText').val('');
                    }
		};		              
                //ko.applyBindings(viewModel,$("#dashboardPage")[0]);
		$("#dashboardPage").on('pageshow', function(event){
			console.debug('dashboardPage pageshow');
			$('#challengesList1').listview('refresh');
			$('#teamList1').listview('refresh');
			$('#teamActivityList1').listview('refresh');
    		});
		$("#dashboardLockedChallengesPage").on('pageshow', function(event){
			console.debug('dashboardLockedChallengesPage pageshow');			
			$('#challengesList2').listview('refresh');
			$('#teamList2').listview('refresh');
			$('#teamActivityList2').listview('refresh');
    		});
		$("#challengesPage").on('pageshow', function(event){
			console.debug('dashboardPage pageshow');
			$('#challengesList3').listview('refresh');
			$('#teamList3').listview('refresh');
			$('#teamActivityList3').listview('refresh');
    		});
		$("#lockedChallengesPage").on('pageshow', function(event){
			console.debug('dashboardLockedChallengesPage pageshow');
			$('#challengesList4').listview('refresh');
			$('#teamList4').listview('refresh');
			$('#teamActivityList4').listview('refresh');
    		});
		$("#myTeamPage").on('pageshow', function(event){
       			console.debug('myTeamPage pageshow');
			$('#chatMessageList').listview('refresh');
    		});
		$("#dashboardPage").on('pageinit', function(event){
       			console.debug('dashboardPage pageinit');		
			$('#dashboardLockedChallengesPage').trigger('pageinit');
			$('#challengesPage').trigger('pageinit');
			$('#lockedChallengesPage').trigger('pageinit');
			$('#myTeamPage').trigger('pageinit');
			$('#helpPage').trigger('pageinit');
			ko.applyBindings(viewModel);
    		});
		$("#challengesPage").on('pageinit', function(event){$('#clickPg31').button();$('#clickPg32').button();$('#clickPg33').button();$('#clickPg34').button();$('#clickPg35').button();
		});
            });
        </script>
        <!-- knockout templates -->

        <!-- group activity templates, keyed by parameter name -->
        <script type='text/html' id='comment'>
            <li data-bind='if: $root.participantGroupId() != participant_group_id()'>
                <div class='group-activity-icon'>
                    <span class='icon-comment lighterprints-blue'></span>
                </div>
                <span class='group-activity'>Participant <strong data-bind='text: participant_number'></strong>
                    <small class='pull-right muted'>
                        <span class="ui-li-aside" data-bind='text: date_created'></span>
                    </small>
                    <div>
                        <span data-bind='if: target_parameter_name() === "activity_performed"'>commented on your completed challenge, <em data-bind='text: target_data_value'></em></span>
                        <span data-bind='if: target_parameter_name() === "chat_message" || target_parameter_name() === "comment"'>replied to your message, &quot;<em data-bind='text: target_data_value'></em>&quot;</span>
                        <div>
                            <small>
                                <span class='icon-quote-left'></span>
                            </small>
                            <span data-bind='text:value'></span>
                            <small>
                                <span class='icon-quote-right'></span>
                            </small>
                        </div>
                    </div>
                </span>
            </li>
        </script>
        <script type='text/html' id='like'>
            <li data-bind='if: $root.participantGroupId() != participant_group_id()'>
                <span class='group-activity-icon'><span class='icon-heart lighterprints-red'></span></span>
                <span class='group-activity'>Participant <strong data-bind='text: participant_number'></strong>
                    <small class='pull-right muted'>
                        <span class="ui-li-aside" data-bind='text: date_created'></span>
                    </small>
                    <div>
                        liked your<span data-bind='if: target_parameter_name() === "activity_performed"'>completed challenge, <em data-bind='text: target_data_value'></em></span>
                        <span data-bind='if: target_parameter_name() === "chat_message" || target_parameter_name() === "comment"'>message, &quot;<em data-bind='text: target_data_value'></em>&quot;</span>
                    </div>
                </span>
            </li>
        </script>
        <script type='text/html' id='chat_message'>
            <li>
            <span class='icon-comment lighterprints-blue'></span>
            <strong>Participant <span data-bind='text: participant_number'></span></strong>
            <small>
                <span class="ui-li-aside" data-bind='text: date_created'></span>
            </small><br>
		<span data-bind='text:value'></span>
            </span>
        </li>
        </script>
        <script type='text/html' id='activity_performed'>
            <li>
            <span class='icon-star text-gold'></span>
            <strong>Participant <span data-bind='text: participant_number'></span></strong>
            <small>
                <span class="ui-li-aside" data-bind='text: date_created'></span>
            </small><br>
            <span> earned <span class='lighterprints-green' data-bind='text:points'></span><span class='icon-leaf lighterprints-green'></span> for <span data-bind='text: $root.groupName'></span> by completing <em><span data-bind='text: display_name'></span></em>.</span>

            </span>
        </li>
    </script>
    <script type='text/html' id='dashboard-challenges-template'>
    	        <li data-icon="false"><div style="text-align: center;">
<img width="100px" height="100px" data-bind='attr: {src: "https://vcweb.asu.edu/static/images/lighterprints/badges/" + name() + ".png" }'><h4 style="white-space: normal;!" class='challenge-name' data-bind='css: status, text:display_name'></h4>
                		<p style="white-space: normal;!"><span data-bind='css: status, text: summary'></span></p>
                <h4><span data-bind='text: points'></span><span class='lighterprints-green icon-leaf icon-2x'></span>
                    <br>
                    <span data-bind='text: time_slots'></span>
                </h4>
		<span data-bind='if: availableNow'>
			<a href="#" style="text-decoration: none;" data-bind='css:status, click: $root.perform1'> Perform 
			</a>
		</span>
		<a style="text-decoration: none;" data-bind='css:status'>
				<span data-bind='if: completed'> Completed <span class='icon-checkmark'></span></span>
				<span data-bind='if: expired'> Expired <span class='icon-warning'></span></span>
				<span data-bind='if: upcoming'> Not yet available <span class='icon-clock'></span></span>
				<span data-bind='if: locked'> Locked <span class='icon-lock'></span></span>
            </a></div>
        </li>
    </script>
	<script type='text/html' id='challenges-template'>
    	        <li data-icon="false"><div style="text-align: center;">
<img width="100px" height="100px" data-bind='attr: {src: "https://vcweb.asu.edu/static/images/lighterprints/badges/" + name() + ".png" }'><h4 style="white-space: normal;!" class='challenge-name' data-bind='css: status, text:display_name'></h4>
<p style="white-space: normal;!"><span data-bind='css: status, text: summary'></span></p>
                <h4><span data-bind='text: points'></span><span class='lighterprints-green icon-leaf icon-2x'></span>
                    <br>
                    <span data-bind='text: time_slots'></span>
                </h4>
			<span data-bind='if: availableNow'>
			<a href="#" style="text-decoration: none;" data-bind='css:status, click: $root.perform2'> Perform 
			</a>
		</span>
		<a style="text-decoration: none;" data-bind='css:status'>
				<span data-bind='if: completed'> Completed <span class='icon-check'></span></span>
				<span data-bind='if: expired'> Expired <span class='icon-warning-sign'></span></span>
				<span data-bind='if: upcoming'> Not yet available <span class='icon-time'></span></span>
				<span data-bind='if: locked'> Locked <span class='icon-lock'></span></span>
            </a></div>
        </li>
	</script>

	<script type='text/html' id='leaderboard-template'>
						<li>
                            <strong>#<span data-bind="text:$index() + 1"></span></strong>
                            <span data-bind='css: { "bold lighterprints-blue": groupName() == $root.groupName()}'>
                            	<span data-bind="text: groupName"></span>
							</span>
			<span class="ui-li-count ui-btn-up-c ui-btn-corner-all" 
data-bind="text: averagePoints"></span>
                        </li>
	</script>
	<script type='text/html' id='myTeam-template'>
			<li>
                                	<span style="color:#42555e;">Participant <span data-bind="text: participant_number"></span> </span><br><span data-bind="text: value"></span>
                   					<span style="color:#42555e;" class="ui-li-aside" data-bind="text: date_created"></span>
                            </li>
	</script>
    <script type='text/html' id='no-group-activity-template'>
        Your group has not had any activity yet.  You can <a href='#dashboardPage'>perform challenges in your dashboard</a>
        or post messages in the <a href='#myTeamPage'>the group wall</a>
        .
    </script>
    </head>
    <body>
    	<!-- Start of page1 #dashboardPage -->
        <div data-role="page" id="dashboardPage" class="ui-responsive-panel">
            <div data-role="panel" id="defaultpanel1" data-position="left" data-display="overlay" data-dismissible="true" data-theme="b">
                <a href="#" data-theme="b" data-role="button" class="innerbutton"><h4><span class="icon-gauge"></span> Dashboard</h4></a>
                <a href="#challengesPage" data-role="button" class="innerbutton"><h4><span class="icon-star"></span> Challenges</h4></a>
                <a href="#myTeamPage" reloadPage="true" data-role="button" class="innerbutton"><h4><span class="icon-user"></span> My Team</h4></a>
                <a href="#helpPage" data-role="button" class="innerbutton"><h4><span class="icon-question"></span> Help</h4></a>
            </div>
            <div data-role="header" data-theme="a" class="navbar" data-position="fixed">
                <img width="30px" height="30px" src="https://vcweb.asu.edu/static/images/lighterprints/logo.png" alt="footprint logo">lighter<strong style="color:#b9ed2e;">footprints</strong>
                <a href="#defaultpanel1" class="ui-btn-right" data-role="button" data-inline="true" data-iconpos="notext" data-theme="a" data-icon="align-justify"></a>
            </div>
            <div data-role="content" data-theme="d">
		<div class="ui-bar-d">
                <h4><span class="icon-gauge lighterprints-grey"> Team Dashboard</span>  </h4>
                <div class="ui-grid-a" data-inset="true">
                    <div class="ui-block-a">
                        <div class="ui-bar ui-bar-e" style="height:90px">
                            Today's Score
                            <br>
                            <span style="font-size:20px;"><span data-bind="text: averagePoints"></span> <span class='icon-leaf lighterprints-green'></span><h1>
                        </div>
                    </div>
                    <div class="ui-block-b">
                        <div class="ui-bar ui-bar-e" style="height:90px">
                            Current Level
                            <div data-bind='if: experimentCompleted'>
                                <img alt='Experiment Completed' class='group-level' width='120' height='70' src='https://vcweb.asu.edu/static/images/lighterprints/experiment-completed.png'>
                            </div>
                            <div data-bind='ifnot: experimentCompleted'>
                                <img alt='Group Level' class='group-level' width="104" height="65" data-bind="attr: { src: 'https://vcweb.asu.edu/static/images/lighterprints/rank' + groupLevel() + '.png' }">
                            </div>
                        </div>
                    </div>
                </div><!-- /grid-a -->
                <div class="ui-grid-a">
                    <div class="ui-block-a">
                        <div class="ui-bar ui-bar-e" style="height:90px">
                            Today's Progress
                            <br>
                            <span style="font-size:20px;" data-bind="text: averagePoints"></span><big> &#47 </big>
                            <span style="font-size:20px;" data-bind="text:pointsToNextLevel"></span>
                        </div>
                    </div>
                    <div class="ui-block-b">
                        <div class="ui-bar ui-bar-e" style="height:90px">
                            Time Remaining<br>
                            <span style="font-size:20px;" data-bind="text: hoursLeft"></span><big> &#58; </big>
                             <span style="font-size:20px;" data-bind="text: minutesLeft"></span>
                        </div>
                    </div>
                </div></div>

		<div class="ui-bar-d">
		<div data-role="navbar" data-theme="d">
	                <h4><span class="lighterprints-grey"> Challenges</span></h4>
			<ul>
			<li>
                               <a href="#" data-theme="b" ><h3><span class="icon-star text-gold "> Unlocked</span></h3></a>
                            </li>
                            <li>
                                <a href="#dashboardLockedChallengesPage"><h3><span class="icon-lock lighterprints-grey"> Locked</span></h3></a>
                            </li>
                        </ul>
                </div>
                    <ul id="challengesList1" data-role="listview" data-inset="true" data-theme="b" data-bind="foreach: unlockedChallenges() ">
			<li data-icon="false"><div style="text-align: center;">
				<img width="100px" height="100px" data-bind='attr: {src: "https://vcweb.asu.edu/static/images/lighterprints/badges/" + name() + ".png" }'><h4 style="white-space: normal;!" class='challenge-name' data-bind='css: status, text:display_name'></h4>
                		<p style="white-space: normal;!"><span data-bind='css: status, text: summary'></span></p>
                		<h4><span data-bind='text: points'></span><span class='lighterprints-green icon-leaf icon-2x'></span><br>
     		               <span data-bind='text: time_slots'></span>
     			       </h4>
				<span data-bind='if: availableNow'><a data-role="button" data-inline="true" style="text-decoration: none;" data-bind='css:status, click: $root.perform1'>Perform </a></span>
				<span data-bind='if: completed'><a data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Completed <span class='icon-checkmark'></span></a></span>
				<span data-bind='if: expired'><a data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Expired <span class='icon-warning'></span></a></span>
				<span data-bind='if: upcoming'><a data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Not yet available <span class='icon-clock'></span></a></span>
				<span data-bind='if: locked'><a data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Locked <span class='icon-lock'></span></a></span>
        		</div></li>
			</ul>
		</div>
		<div class="ui-bar-d">
                <h4><span class="icon-trophy text-gold "></span> Leaderboard</h4>
                    <ul id="teamList1" data-role="listview" data-bind="template: {name:'leaderboard-template', foreach: groupData}" data-inset="true" data-theme="b">
                    </ul>
		</div>
		<div class="ui-bar-d">
                <h4><span class="icon-user lighterprints-blue"></span> Team Activity</h4>
                    <div data-bind='ifnot: hasGroupActivity()'>
                        <div data-bind='template: { name: "no-group-activity-template" }'>
                        </div>
                    </div>
                    <div class='table group-activity'>
                        <ul id="teamActivityList1" data-role="listview" data-inset="true" data-bind='template: { name: groupActivityTemplate, foreach: groupActivity.slice(0, 6) }'>
                        </ul>
                    </div>
                </div>
            </div>
             <div data-role="footer" data-theme="c" >
                <div class="ui-bar-b" style="font-size:15px;text-align:center;">
                    <div data-role="controlgroup" data-type="horizontal" data-theme="b">
                        <a href="#" style="text-decoration: none;"> Dashboard</a>
                        <a href="#challengesPage" style="text-decoration: none;"> Challenges</a>
                        <a href="#myTeamPage" style="text-decoration: none;"> My Team</a>
                        <a href="#helpPage" style="text-decoration: none;"> Help</a>
                    </div>
                    2013 Arizona Board Of Regents
                </div>
                <div class="footerbar">
                    <img width="30px" height="30px" src="https://vcweb.asu.edu/static/images/lighterprints/logo.png" alt="footprint logo">
                    lighter<strong>footprints</strong>
                </div>
            </div>
		<div data-role="popup" id="popupDialog1" data-overlay-theme="a" data-theme="c">
			
			<div data-role="content" data-theme="a" style="text-align: center;">
				<div data-bind='with: lastPerformedActivity'>		            				
			                <img alt='Lighterprints Activity Badge' data-bind='attr: {src: "/static/images/lighterprints/badges/" + name() + ".png" }'>
				        <h3 style="white-space: normal;!">You completed a challenge!</h3>
					<p style="white-space: normal;!"><strong><em data-bind='text: display_name'></em></strong> for <span class='lighterprints-green' data-bind='text: points'></span><i class='icon-leaf lighterprints-green'></i>
					</p>
					<p style="white-space: normal;!" data-bind='text: summary'></p>
			        </div>
				<a href="#" data-role="button" data-inline="true" data-rel="back">DONE</a> 
			</div>
		</div>
        </div>
        <!-- /page dashboardPage-->

	<!-- Start of page2 #dashboardLockedChallengesPage -->
        <div data-role="page" id="dashboardLockedChallengesPage" class="ui-responsive-panel">
            <div data-role="panel" id="defaultpanel2" data-position="left" data-display="overlay" data-dismissible="true" >
                <a href="#" data-theme="b" data-role="button" class="innerbutton"><h4><span class="icon-gauge"></span> Dashboard</h4></a>
                <a href="#challengesPage" data-role="button" class="innerbutton"><h4><span class="icon-star"></span> Challenges</h4></a>
                <a href="#myTeamPage" reloadPage="true" data-role="button" class="innerbutton"><h4><span class="icon-user"></span> My Team</h4></a>
                <a href="#helpPage" data-role="button" class="innerbutton"><h4><span class="icon-question"></span> Help</h4></a>
            </div>
            <div data-role="header" data-theme="a" class="navbar" data-position="fixed">
                <img width="30px" height="30px" src="https://vcweb.asu.edu/static/images/lighterprints/logo.png" alt="footprint logo">lighter<strong style="color:#b9ed2e;">footprints</strong>
                <a href="#defaultpanel2" class="ui-btn-right" data-role="button" data-inline="true" data-iconpos="notext" data-theme="a" data-icon="align-justify"></a>
            </div>
            <div data-role="content" data-theme="d">
		<div class="ui-bar-d">
                <h4><span class="icon-gauge lighterprints-grey"> Team Dashboard</span>  </h4>
                <div class="ui-grid-a" data-inset="true">
                    <div class="ui-block-a">
                        <div class="ui-bar ui-bar-e" style="height:90px">
                            Today's Score
                            <br>
                            <span style="font-size:20px;"><span data-bind="text: averagePoints"></span> <span class='icon-leaf lighterprints-green'></span><h1>
                        </div>
                    </div>
                    <div class="ui-block-b">
                        <div class="ui-bar ui-bar-e" style="height:90px">
                            Current Level
                            <div data-bind='if: experimentCompleted'>
                                <img alt='Experiment Completed' class='group-level' width='120' height='70' src='https://vcweb.asu.edu/static/images/lighterprints/experiment-completed.png'>
                            </div>
                            <div data-bind='ifnot: experimentCompleted'>
                                <img alt='Group Level' class='group-level' width="104" height="65" data-bind="attr: { src: 'https://vcweb.asu.edu/static/images/lighterprints/rank' + groupLevel() + '.png' }">
                            </div>
                        </div>
                    </div>
                </div><!-- /grid-a -->
                <div class="ui-grid-a">
                    <div class="ui-block-a">
                        <div class="ui-bar ui-bar-e" style="height:90px">
                            Today's Progress
                            <br>
                            <span style="font-size:20px;" data-bind="text: averagePoints"></span><big> &#47; </big>
                            <span style="font-size:20px;" data-bind="text:pointsToNextLevel"></span>
                        </div>
                    </div>
                    <div class="ui-block-b">
                        <div class="ui-bar ui-bar-e" style="height:90px">
                            Time Remaining<br>
                            <span style="font-size:20px;" data-bind="text: hoursLeft"></span><big> &#58; </big>
                             <span style="font-size:20px;" data-bind="text: minutesLeft"></span>
                        </div>
                    </div>
                </div></div>

		<div class="ui-bar-d">
		<div data-role="navbar" data-theme="d">
                <h4><span class="lighterprints-grey"> Challenges</span></h4>
                        <ul>
                            <li>
                                <a href="#dashboardPage"><h3><span class="icon-star text-gold "> Unlocked</span></h3></a>
                            </li>
                            <li>
                                <a href="#" data-theme="b"><h3><span class="icon-lock lighterprints-grey"> Locked</span></h3></a>
                            </li>
                        </ul>
                    </div>
                    <ul id="lockedChallengesList2" data-role="listview" data-inset="true" data-theme="b" data-bind="foreach: lockedChallenges()">
			<li data-icon="false"><div style="text-align: center;">
				<img width="100px" height="100px" data-bind='attr: {src: "https://vcweb.asu.edu/static/images/lighterprints/badges/" + name() + ".png" }'><h4 style="white-space: normal;!" class='challenge-name' data-bind='css: status, text:display_name'></h4>
                		<p style="white-space: normal;!"><span data-bind='css: status, text: summary'></span></p>
                		<h4><span data-bind='text: points'></span><span class='lighterprints-green icon-leaf icon-2x'></span><br>
     		               <span data-bind='text: time_slots'></span>
     			       </h4>
				<span data-bind='if: availableNow'><a data-role="button" data-inline="true" style="text-decoration: none;" data-bind='css:status, click: $root.perform1'>Perform </a></span>
				<span data-bind='if: completed'><a data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Completed <span class='icon-checkmark'></span></a></span>
				<span data-bind='if: expired'><a data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Expired <span class='icon-warning'></span></a></span>
				<span data-bind='if: upcoming'><a data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Not yet available <span class='icon-clock'></span></a></span>
				<span data-bind='if: locked'><a data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Locked <span class='icon-lock'></span></a></span>
        		</div></li>
		</ul>
		</div>
		<div class="ui-bar-d">
                <h4><span class="icon-trophy text-gold "></span> Leaderboard</h4>
                    <ul id="teamList2" data-role="listview" data-bind="template: {name:'leaderboard-template', foreach: groupData}" data-inset="true" data-theme="b">
                    </ul>
		</div>
		<div class="ui-bar-d">
                <h4><span class="icon-user lighterprints-blue"></span> Team Activity</h4>
                    <div data-bind='ifnot: hasGroupActivity()'>
                        <div data-bind='template: { name: "no-group-activity-template" }'>
                        </div>
                    </div>
                    <div class='table group-activity'>
                        <ul id="teamActivityList2" data-role="listview" data-inset="true" data-bind='template: { name: groupActivityTemplate, foreach: groupActivity.slice(0, 6) }'>
                        </ul>
                    </div>
                </div>
            </div>
             <div data-role="footer" data-theme="c">
                <div class="ui-bar-b" style="font-size:15px;text-align:center;">
                    <div data-role="controlgroup" data-type="horizontal" data-theme="b">
                        <a href="#" style="text-decoration: none;"> Dashboard</a>
                        <a href="#challengesPage" style="text-decoration: none;"> Challenges</a>
                        <a href="#myTeamPage" style="text-decoration: none;"> My Team</a>
                        <a href="#helpPage" style="text-decoration: none;"> Help</a>
                    </div>
                    2013 Arizona Board Of Regents
                </div>
                <div class="footerbar">
                    <img width="30px" height="30px" src="https://vcweb.asu.edu/static/images/lighterprints/logo.png" alt="footprint logo">
                    lighter<strong>footprints</strong>
                </div>
            </div>
        </div>
        <!-- /page dashboardLockedChallengesPage-->
	<!-- Start of page 3 challengesPage -->
        <div data-role="page" id="challengesPage" class="ui-responsive-panel">
            <div data-role="panel" id="defaultpanel3" data-position="left" data-display="overlay" data-dismissible="true" >
                <a href="#dashboardPage" data-role="button" class="innerbutton"><h4><span class="icon-gauge"></span> Dashboard</h4></a>
                <a href="#" data-theme="b" data-role="button" class="innerbutton"><h4><span class="icon-star"></span> Challenges</h4></a>
                <a href="#myTeamPage" reloadPage="true" data-role="button" class="innerbutton"><h4><span class="icon-user"></span> My Team</h4></a>
                <a href="#helpPage" data-role="button" class="innerbutton"><h4><span class="icon-question"></span> Help</h4></a>
            </div>
            <div data-role="header" data-theme="a" class="navbar" data-position="fixed">
                <img width="30px" height="30px" src="https://vcweb.asu.edu/static/images/lighterprints/logo.png" alt="footprint logo">lighter<strong style="color:#b9ed2e;">footprints</strong>
                <a href="#defaultpanel3" class="ui-btn-right" data-role="button" data-inline="true" data-iconpos="notext" data-theme="a" data-icon="align-justify"></a>
            </div>
            <div data-role="content" data-theme="d">
		<div class="ui-bar-d">
		<div data-role="navbar" data-theme="d">
                <h4><span class="lighterprints-grey icon-star"> Challenges</span></h4>
                        <ul>
                            <li>
                                <a href="#" data-theme="b" ><h3><span class="icon-star text-gold "> Unlocked</span></h3></a>
                            </li>
                            <li>
                                <a href="#lockedChallengesPage"><h3><span class="icon-lock lighterprints-grey"> Locked</span></h3></a>
                            </li>
                        </ul>
                    </div>
                    <ul id="challengesList3" data-role="listview" data-inset="true" data-theme="b" data-bind="foreach: unlockedChallenges()"><li data-icon="false"><div style="text-align: center;">
				<img width="100px" height="100px" data-bind='attr: {src: "https://vcweb.asu.edu/static/images/lighterprints/badges/" + name() + ".png" }'><h4 style="white-space: normal;!" class='challenge-name' data-bind='css: status, text:display_name'></h4>
                		<p style="white-space: normal;!"><span data-bind='css: status, text: summary'></span></p>
                		<h4><span data-bind='text: points'></span><span class='lighterprints-green icon-leaf icon-2x'></span><br>
     		               <span data-bind='text: time_slots'></span>
     			       </h4>
				<span data-bind='if: availableNow'><a id="clickPg31" data-role="button" data-inline="true" style="text-decoration: none;" data-bind='css:status, click: $root.perform2'>Perform </a></span>
				<span data-bind='if: completed'><a id="clickPg32" data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Completed <span class='icon-checkmark'></span></a></span>
				<span data-bind='if: expired'><a id="clickPg33" data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Expired <span class='icon-warning'></span></a></span>
				<span data-bind='if: upcoming'><a id="clickPg34" data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Not yet available <span class='icon-clock'></span></a></span>
				<span data-bind='if: locked'><a id="clickPg35" data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Locked <span class='icon-lock'></span></a></span>
        		</div></li>	
			</ul>
		</div>
		<div class="ui-bar-d">
                <h4><span class="icon-trophy text-gold "></span> Leaderboard</h4>
                    <ul id="teamList3" data-role="listview" data-bind="template: {name:'leaderboard-template', foreach: groupData}" data-inset="true" data-theme="b">
                    </ul>
		</div>
		<div class="ui-bar-d">
                <h4><span class="icon-user lighterprints-blue"></span> Team Activity</h4>
                    <div data-bind='ifnot: hasGroupActivity()'>
                        <div data-bind='template: { name: "no-group-activity-template" }'>
                        </div>
                    </div>
                    <div class='table group-activity'>
                        <ul id="teamActivityList3" data-role="listview" data-inset="true" data-bind='template: { name: groupActivityTemplate, foreach: groupActivity.slice(0, 6) }'>
                        </ul>
                    </div>
                </div>
            </div>
             <div data-role="footer" data-theme="c">
                <div class="ui-bar-b" style="font-size:15px;text-align:center;">
                    <div data-role="controlgroup" data-type="horizontal" data-theme="b">
                        <a href="#dashboardPage" style="text-decoration: none;"> Dashboard</a>
                        <a href="#"style="text-decoration: none;"> Challenges</a>
                        <a href="#myTeamPage" style="text-decoration: none;"> My Team</a>
                        <a href="#helpPage" style="text-decoration: none;"> Help</a>
                    </div>
                    2013 Arizona Board Of Regents
                </div>
                <div class="footerbar">
                    <img width="30px" height="30px" src="https://vcweb.asu.edu/static/images/lighterprints/logo.png" alt="footprint logo">
                    lighter<strong>footprints</strong>
                </div>
            </div>
	<div data-role="popup" id="popupDialog3" data-overlay-theme="a" data-theme="c" class="ui-corner-all">
			
			<div data-role="content" data-theme="a" style="text-align: center;">
				<div data-bind='with: lastPerformedActivity'>		            				
			                <img alt='Lighterprints Activity Badge' data-bind='attr: {src: "/static/images/lighterprints/badges/" + name() + ".png" }'>
				        <h3 style="white-space: normal;!">You completed a challenge!</h3>
					<p style="white-space: normal;!"><strong><em data-bind='text: display_name'></em></strong> for <span class='lighterprints-green' data-bind='text: points'></span><i class='icon-leaf lighterprints-green'></i>
					</p>
					<p style="white-space: normal;!" data-bind='text: summary'></p>
			        </div>
				<a href="#" data-role="button" data-inline="true" data-rel="back">DONE</a> 
			</div>
		</div>
        </div>
        <!-- /page challengesPage-->
	<!-- Start of page4 #lockedChallengesPage -->
        <div data-role="page" id="lockedChallengesPage" class="ui-responsive-panel">
            <div data-role="panel" id="defaultpanel4" data-position="left" data-display="overlay" data-dismissible="true" >
                <a href="#dashboardPage" data-role="button" class="innerbutton"><h4><span class="icon-gauge"></span> Dashboard</h4></a>
                <a href="#" data-theme="b" data-role="button" class="innerbutton"><h4><span class="icon-star"></span> Challenges</h4></a>
                <a href="#myTeamPage" reloadPage="true" data-role="button" class="innerbutton"><h4><span class="icon-user"></span> My Team</h4></a>
                <a href="#helpPage" data-role="button" class="innerbutton"><h4><span class="icon-question"></span> Help</h4></a>
            </div>
            <div data-role="header" data-theme="a" class="navbar" data-position="fixed">
                <img width="30px" height="30px" src="https://vcweb.asu.edu/static/images/lighterprints/logo.png" alt="footprint logo">lighter<strong style="color:#b9ed2e;">footprints</strong>
                <a href="#defaultpanel4" class="ui-btn-right" data-role="button" data-inline="true" data-iconpos="notext" data-theme="a" data-icon="align-justify"></a>
            </div>
            <div data-role="content" data-theme="d">
		<div class="ui-bar-d">
		<div data-role="navbar" data-theme="d">
                <h4><span class="lighterprints-grey icon-star"> Challenges</span></h4>
                        <ul>
                            <li>
                                <a href="#challengesPage"><h3><span class="icon-star text-gold "> Unlocked</span></h3></a>
                            </li>
                            <li>
                                <a href="#" data-theme="b"><h3><span class="icon-lock lighterprints-grey"> Locked</span></h3></a>
                            </li>
                        </ul>
                    </div>
                    <ul id="lockedChallengesList4" data-role="listview" data-inset="true" data-theme="b" data-bind="foreach: lockedChallenges()"><li data-icon="false"><div style="text-align: center;">
				<img width="100px" height="100px" data-bind='attr: {src: "https://vcweb.asu.edu/static/images/lighterprints/badges/" + name() + ".png" }'><h4 style="white-space: normal;!" class='challenge-name' data-bind='css: status, text:display_name'></h4>
                		<p style="white-space: normal;!"><span data-bind='css: status, text: summary'></span></p>
                		<h4><span data-bind='text: points'></span><span class='lighterprints-green icon-leaf icon-2x'></span><br>
     		               <span data-bind='text: time_slots'></span>
     			       </h4>
				<span data-bind='if: availableNow'><a data-role="button" data-inline="true" style="text-decoration: none;" data-bind='css:status, click: $root.perform2'>Perform </a></span>
				<span data-bind='if: completed'><a data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Completed <span class='icon-checkmark'></span></a></span>
				<span data-bind='if: expired'><a data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Expired <span class='icon-warning'></span></a></span>
				<span data-bind='if: upcoming'><a data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Not yet available <span class='icon-clock'></span></a></span>
				<span data-bind='if: locked'><a data-role="button" data-inline="true" style="text-decoration: none;" class="ui-disabled" data-bind='css:status'> Locked <span class='icon-lock'></span></a></span>
        		</div></li>
			</ul>
		</div>
		<div class="ui-bar-d">
                <h4><span class="icon-trophy text-gold "></span> Leaderboard</h4>
                    <ul id="teamList4" data-role="listview" data-bind="template: {name:'leaderboard-template', foreach: groupData}" data-inset="true" data-theme="b">
                    </ul>
		</div>
		<div class="ui-bar-d">
                <h4><span class="icon-user lighterprints-blue"></span> Team Activity</h4>
                    <div data-bind='ifnot: hasGroupActivity()'>
                        <div data-bind='template: { name: "no-group-activity-template" }'>
                        </div>
                    </div>
                    <div class='table group-activity'>
                        <ul id="teamActivityList4" data-role="listview" data-inset="true" data-bind='template: { name: groupActivityTemplate, foreach: groupActivity.slice(0, 6) }'>
                        </ul>
                    </div>
                </div>
            </div>
             <div data-role="footer" data-theme="c">
                <div class="ui-bar-b" style="font-size:15px;text-align:center;">
                    <div data-role="controlgroup" data-type="horizontal" data-theme="b">
                        <a href="#dashboardPage" style="text-decoration: none;"> Dashboard</a>
                        <a href="#" style="text-decoration: none;"> Challenges</a>
                        <a href="#myTeamPage" style="text-decoration: none;"> My Team</a>
                        <a href="#helpPage" style="text-decoration: none;"> Help</a>
                    </div>
                    2013 Arizona Board Of Regents
                </div>
                <div class="footerbar">
                    <img width="30px" height="30px" src="https://vcweb.asu.edu/static/images/lighterprints/logo.png" alt="footprint logo">
                    lighter<strong>footprints</strong>
                </div>
            </div>
        </div>
        <!-- /page lockedChallengesPage-->
	<!-- Start of page5: #myTeamPage -->
        <div data-role="page" id="myTeamPage" class="ui-responsive-panel">
            <div data-role="panel" id="defaultpanel5" data-theme="b" data-position="left" data-display="overlay" data-dismissible="true" >
                <a href="#dashboardPage" data-role="button" class="innerbutton"><h4><span class="icon-gauge"></span> Dashboard</h4></a>
                <a href="#challengesPage" data-role="button" class="innerbutton"><h4><span class="icon-star"></span> Challenges</h4></a>
                <a href="#" data-theme="b" data-role="button" class="innerbutton"><h4><span class="icon-user"></span> My Team</h4></a>
                <a href="#helpPage" data-role="button" class="innerbutton"><h4><span class="icon-question"></span> Help</h4></a>
            </div>
            <div data-role="header" data-theme="a" class="navbar" data-position="fixed" >
                <img width="30px" height="30px" src="https://vcweb.asu.edu/static/images/lighterprints/logo.png" alt="footprint logo">lighter<strong style="color:#b9ed2e;">footprints</strong>
                <a href="#defaultpanel5" class="ui-btn-right" data-role="button" data-inline="true" data-iconpos="notext" data-theme="a" data-icon="align-justify"></a>
            </div>
            <div data-role="content" data-theme="d">
                <h4><span class="icon-comment lighterprints-grey"> My Team</span></h4>
		
			<input type="hidden" name="participant_group_id" value='{{participant_group_relationship.id}}'>
			<input type="text" id="chatText" name="message" placeholder="Send a message to your group">
			<a href="#" data-theme="a" data-inline="true" data-role="button" data-bind='click: $root.send'>Send</a>
		<div class="ui-body-b">
			<div data-bind="ifnot: hasChatMessages() " data-inset="true" data-theme="b">
                        No chat messages have been posted yet.
                    </div>
                   <div data-bind="if: hasChatMessages()" data-theme="b">
                        <ul id="chatMessageList" data-role="listview" data-bind="template: {name:'myTeam-template', foreach: chatMessages}" data-inset="true" style="overflow-y: scroll;height:600px;">               
                        </ul>
                    </div>
                </div>
            </div>
            <div data-role="footer" data-theme="c">
                <div class="ui-bar-b" style="font-size:15px;text-align:center;">
                    <div data-role="controlgroup" data-type="horizontal" data-theme="b">
                        <a href="#dashboardPage" style="text-decoration: none;"> Dashboard</a>
                        <a href="#challengesPage" style="text-decoration: none;"> Challenges</a>
                        <a href="#" style="text-decoration: none;"> My Team</a>
                        <a href="#helpPage" style="text-decoration: none;"> Help</a>
                    </div>
                    2013 Arizona Board Of Regents
                </div>
                <div class="footerbar">
                    <img width="30px" height="30px" src="https://vcweb.asu.edu/static/images/lighterprints/logo.png" alt="footprint logo">
                    lighter<strong>footprints</strong>
                </div>
            </div>
        </div>
        <!-- /page myTeamPage-->
	<!-- Start of page6: #helpPage -->
		 <div data-role="page" id="helpPage" class="ui-responsive-panel">
            <div data-role="panel" id="defaultpanel6" data-theme="b" data-position="left" data-display="overlay" data-dismissible="true" >
                <a href="#dashboardPage" data-role="button" class="innerbutton"><h4><span class="icon-gauge"></span> Dashboard</h4></a>
                <a href="#challengesPage" data-role="button" class="innerbutton"><h4><span class="icon-star"></span> Challenges</h4></a>
                <a href="#myTeamPage" data-role="button" class="innerbutton"><h4><span class="icon-user"></span> My Team</h4></a>
                <a href="#" data-theme="b" data-role="button" class="innerbutton"><h4><span class="icon-question"></span> Help</h4></a>
            </div>
            <div data-role="header" data-theme="a" class="navbar" data-position="fixed" >
                <img width="30px" height="30px" src="https://vcweb.asu.edu/static/images/lighterprints/logo.png" alt="footprint logo">lighter<strong style="color:#b9ed2e;">footprints</strong>
                <a href="#defaultpanel6" class="ui-btn-right" data-role="button" data-inline="true" data-iconpos="notext" data-theme="a" data-icon="align-justify"></a>
            </div>
            <div data-role="content" data-theme="d">
                <div class="ui-block-d" data-inset="true">
		    <h4><span class="icon-question lighterprints-grey"> Help</span></h4>
                    <h4>Instructions</h4>
                    <p>
                        You have been randomly placed in a group of <b>5 participants</b>. 
                        In this experiment you can perform virtual actions that represent green alternatives to some common daily  
                        activities.  Some of these activities are available all day, and others are only available at 
                        specific times.  You can learn more about them by clicking on the <a href="#challengesPage" style="text-decoration: none;">Challenges tab</a>
                        and selecting an activity.
                    </p>
                    <b>Challenges, Green Points, and Levels</b>
                    <p>
                        Each <strong class="text-gold">challenge</strong>
                        is worth a certain number of <strong class="lighterprints-green">green points <span class="icon-leaf"></span></strong>. 
                        For example, <em>Eat locally grown food for lunch</em>
                        (available from 12-2pm) is worth <span class="lighterprints-green">15 <span class="icon-leaf"></span></span>
                        green points. 
                        In order to perform this challenge you must login to the application between 12pm and 2pm, 
                        select the challenge from the list below, and click the &quot;Perform&quot; button.
                    </p>
                    <p>
                        Your group is currently <strong class="text-gold">Level <span data-bind="text:groupLevel"></span></strong>
                        and has an average score of <strong class="lighterprints-green"><span data-bind="text:averagePoints"></span><span class="icon-leaf"></span></strong>.  In order to 
                        advance in level and unlock more challenges the <em>average number of points contributed by each member of your group</em>
                        must be equal to or greater than <strong class="lighterprints-green"><span data-bind="text: pointsToNextLevel"></span><span class="icon-leaf"></span></strong>.
                        In order to reach this target you and a majority of the members of your group must perform
                        high point challenges when they are available.
                    </p>
                    <b>How to participate</b>
                    <p>
                        To participate, simply click on the <a href="#challengesPage" style="text-decoration: none;">Challenges tab</a>, and select a challenge you'd like to perform. 
                        You can leave messages for the other members n your group via the <a href="#myTeamPage" style="text-decoration: none;">My Group tab</a>
                        or use the <a href="#dashboardPage" style="text-decoration: none;">Dashboard</a>
                        to view your group's progress.
                    </p>
                </div><br>
                <div class="ui-body-d">
                    <h4>Frequently Asked Questions</h4>
                    <ul data-role="listview" data-inset="true" data-theme="b">
                        <li>
                            <h4 style="white-space: normal;!">I performed an activity worth 15 points but only 3 points were added to Today's Progress and Today's Score.  Why?</h4>
                            <p style="white-space: normal;!">
                                The numbers in Today's Score Today's Progress represent your group's <b>average number of earned green points</b>.  If there are 5
                                people in your group, performing a 15 point activity adds 3 points to the group average (15 / 5 = 3).
                            </p>
                        </li>
                        <li>
                            <h4 style="white-space: normal;!">Why do the challenges performed in the previous day not count for today?</h4>
                            <p style="white-space: normal;!">
                                In order to advance in level and unlock more challenges you must reach an average level of points in your
                                group during one day, starting at 0.00AM.  Every day at midnight the server will check your group"s average number of
                                points and determine whether or not you should move on to the next level.
                                If your group advances in level your group will once again start at 0 points with the additional unlocked
                                challenges for that level available to perform. If your group did not reach the next level, your group
                                will start with 0 points at the same level with the same challenges available as the previous day.
                            </p>
                        </li>
                        <li>
                            <h4 style="white-space: normal;!">I don't have a car or anyone to carpool with, so how can I carpool?</h4>
                            <p style="white-space: normal;!">
                                You don't have to actually perform the activity in the real world to click on "perform". These are just
                                virtual challenges for the time being. In the future we plan to allow participants to gain points by
                                actually performing these challenges.
                            </p>
                        </li>
                    </ul>
                </div>
            </div>
            <div data-role="footer" data-theme="c">
                <div class="ui-bar-b" style="font-size:15px;text-align:center;">
                    <div data-role="controlgroup" data-type="horizontal" data-theme="b">
                        <a href="#dashboardPage" style="text-decoration: none;"> Dashboard</a>
                        <a href="#challengesPage" style="text-decoration: none;"> Challenges</a>
                        <a href="#myTeamPage" style="text-decoration: none;"> My Team</a>
                        <a href="#" style="text-decoration: none;"> Help</a>
                    </div>
                    2013 Arizona Board Of Regents
                </div>
                <div class="footerbar">
                    <img width="30px" height="30px" src="https://vcweb.asu.edu/static/images/lighterprints/logo.png" alt="footprint logo">
                    lighter<strong>footprints</strong>
                </div>
            </div>
        </div>
    </body>
</html>
